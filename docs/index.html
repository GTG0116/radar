<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MRMS Radar Loop</title>
    <style>
        body { background-color: #1a1a1a; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 20px; }
        #radar-container { max-width: 1200px; margin: 0 auto; position: relative; }
        img { width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.5); }
        .controls { margin-top: 15px; }
        button { background: #333; color: white; border: 1px solid #555; padding: 10px 20px; cursor: pointer; border-radius: 4px; font-size: 16px;}
        button:hover { background: #444; }
    </style>
</head>
<body>

    <div id="radar-container">
        <img id="radar-image" src="" alt="Loading radar...">
    </div>

    <div class="controls">
        <button id="play-pause">Pause</button>
    </div>

    <script>
        let frames = [];
        let currentIndex = 0;
        let playing = true;
        let interval;

        async function init() {
            try {
                // Fetch the list of frames generated by the Python script
                const response = await fetch('frames.json');
                frames = await response.json();
                
                if (frames.length > 0) {
                    // Preload images
                    frames.forEach(frame => {
                        const img = new Image();
                        img.src = 'frames/' + frame;
                    });
                    
                    currentIndex = frames.length - 1; // Start at most recent
                    document.getElementById('radar-image').src = 'frames/' + frames[currentIndex];
                    startLoop();
                }
            } catch (error) {
                console.error("Error loading frames:", error);
            }
        }

        function advanceFrame() {
            currentIndex++;
            if (currentIndex >= frames.length) currentIndex = 0;
            document.getElementById('radar-image').src = 'frames/' + frames[currentIndex];
        }

        function startLoop() {
            interval = setInterval(advanceFrame, 500); // 500ms per frame
        }

        document.getElementById('play-pause').addEventListener('click', (e) => {
            playing = !playing;
            if (playing) {
                startLoop();
                e.target.innerText = "Pause";
            } else {
                clearInterval(interval);
                e.target.innerText = "Play";
            }
        });

        init();
    </script>
</body>
</html>
